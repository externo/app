"use strict";function authService(r,e,s){return{login:function(n,t,i){var o=e+"login?username="+n.username+"&password="+n.password;r.get(o,s).success(function(r){sessionStorage.currentUser=JSON.stringify(r),t(r)}).error(i)},register:function(s,n,t){var i={method:"POST",url:e+"users",data:s};r(i).success(function(r){sessionStorage.currentUser=JSON.stringify(r),n(r)}).error(t)},logout:function(){delete sessionStorage.currentUser},getCurrentUser:function(){var r=sessionStorage.currentUser;return r?JSON.parse(sessionStorage.currentUser):void 0},isAnonymous:function(){return void 0==sessionStorage.currentUser},isLoggedIn:function(){return void 0!=sessionStorage.currentUser},isNormalUser:function(){var r=this.getCurrentUser();return void 0!=r&&!r.isAdmin},isAdmin:function(){var r=this.getCurrentUser();return void 0!=r&&r.isAdmin},getAuthHeaders:function(){var r={},e=this.getCurrentUser();return e&&(r.Authorization="Bearer "+e.access_token),r}}}angular.module("app").factory("authService",authService);