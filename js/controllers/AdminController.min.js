"use strict";function AdminController(e,o,s,r,i,t,n,d,a,c,l,u,m,f){function h(e){var o="#"+e.objectId;p=$(o),p.click(function(e){e.stopPropagation()}),p.find(".close").click(function(e){e.stopPropagation()}),$("[md-page-header]").addClass("blur"),$("md-list-item").addClass("blur").removeClass("clicked").addClass("notClicked"),p.removeClass("blur").removeClass("notClicked").addClass("clicked"),$("input").prop("checked",!1),p.find("input").prop("checked",!0),C=e}var g=this;g.$mdMedia=c;var p,C={};g.device={direction:c("min-width: 12cm")?"row":"column",size:c("max-width: 27cm")},$(window).on("resize.doResize",_.debounce(function(){g.device={direction:c("min-width: 12cm")?"row":"column",size:c("max-width: 27cm")}},100)),r.authService=u,r.logout=function(){u.logout(),m.showInfo("Logout successful"),d.path("/")},r.reloadAds=function(){l.getAds.success(function(e){g.ads=e.results,m.showInfo("Обявите са заредени успешно...")}).error(function(e){m.showError("Има проблем със зареждането на обявите!",e)}),l.getCategories.success(function(e){r.categories=e.results})},r.reloadAds(),g.getAd=function(e){h(e),g.newAd=e},r.notClickedAd=function(e){var o="#"+e;p=$(o),p.find("input").prop("checked",!1),$("[md-page-header]").removeClass("blur"),$("md-list-item").removeClass("blur").removeClass("clicked").addClass("notClicked")},r.fileSelected1=function(s){var r=s.files[0];if(r.type.match(/image\/.*/)){var i=new FileReader;i.onload=function(){$("#image1preview").html("<img class='ad-image' src='"+i.result+"'>")},i.readAsDataURL(r);var t=r.name.indexOf("\\")>=0?r.name.lastIndexOf("\\"):r.name.lastIndexOf("/"),n=r.name.substring(t),d={method:"POST",url:o+"files/"+n,headers:f.headers,data:r};e(d).success(function(e){e.__type="File",C.img1=e}).error(function(e){m.showError("Има проблем със добавянето на снимката!",e)})}else $("#image1preview").html("<p>Опитваш се да качиш файл, различен от снимка!</p>")},g.editAd=function(){var i={method:"PUT",url:o+"classes/Part/"+C.objectId,headers:s.headers,data:C};e(i).success(function(e){m.showInfo("Обявата е редактирана."),r.editedAd={}}).error(function(e){m.showError("Неуспешен опит да редактирате обявата!",e),d.path("/editAd")})},g.deleteAd=function(r){var i="#"+r,t=$(i),n={method:"DELETE",url:o+"classes/Part/"+r,headers:s.headers};e(n).success(function(e){m.showInfo("Обявата е изтрита."),t.hide()}).error(function(e){m.showError("Неуспешен опит да изтриете обявата!",e)})};var v=$("#panel"),w=$(".show-publish");g.toggleCode=function(){v.toggleClass("viewCode"),w.toggleClass("md-accent").toggleClass("md-primary")}}angular.module("app").controller("AdminController",AdminController);