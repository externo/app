"use strict";function AdminController(e,o,s,i,d,n,t,r,a,c,l,u,m,f){function h(e){var o="#"+e.objectId;p=$(o),p.click(function(e){e.stopPropagation()}),p.find(".close").click(function(e){e.stopPropagation()}),$("[md-page-header]").addClass("blur"),$("md-list-item").addClass("blur").removeClass("clicked").addClass("notClicked"),p.removeClass("blur").removeClass("notClicked").addClass("clicked"),$("input").prop("checked",!1),p.find("input").prop("checked",!0),w=e}var g=this;g.$mdMedia=c;var p,w={};g.device={direction:c("min-width: 12cm")?"row":"column",size:c("max-width: 27cm")},$(window).on("resize.doResize",_.debounce(function(){console.log("window width changed "+JSON.stringify(g.$mdMedia("width"))),g.device={direction:c("min-width: 12cm")?"row":"column",size:c("max-width: 27cm")}},100)),i.authService=u,i.logout=function(){u.logout(),m.showInfo("Logout successful"),r.path("/")},i.reloadAds=function(){l.getAds.success(function(e){g.ads=e.results,m.showInfo("Обявите са заредени успешно...")}).error(function(e){m.showError("Има проблем със зареждането на обявите!",e)}),l.getCategories.success(function(e){i.categories=e.results})},i.reloadAds(),g.getAd=function(e){h(e),g.newAd=e},i.notClickedAd=function(e){var o="#"+e;p=$(o),p.find("input").prop("checked",!1),$("[md-page-header]").removeClass("blur"),$("md-list-item").removeClass("blur").removeClass("clicked").addClass("notClicked")},i.fileSelected1=function(s){var i=s.files[0];if(i.type.match(/image\/.*/)){var d=new FileReader;d.onload=function(){$("#image1preview").html("<img class='ad-image' src='"+d.result+"'>")},d.readAsDataURL(i);var n=i.name.indexOf("\\")>=0?i.name.lastIndexOf("\\"):i.name.lastIndexOf("/"),t=i.name.substring(n),r={method:"POST",url:o+"files/"+t,headers:f.headers,data:i};e(r).success(function(e){e.__type="File",w.img1=e}).error(function(e){m.showError("Има проблем със добавянето на снимката!",e)})}else $("#image1preview").html("<p>Опитваш се да качиш файл, различен от снимка!</p>")},g.editAd=function(){var d={method:"PUT",url:o+"classes/Part/"+w.objectId,headers:s.headers,data:w};e(d).success(function(e){m.showInfo("Обявата е редактирана."),i.editedAd={}}).error(function(e){m.showError("Неуспешен опит да редактирате обявата!",e),r.path("/editAd")})},g.deleteAd=function(i){var d="#"+i,n=$(d),t={method:"DELETE",url:o+"classes/Part/"+i,headers:s.headers};e(t).success(function(e){m.showInfo("Обявата е изтрита."),n.hide()}).error(function(e){m.showError("Неуспешен опит да изтриете обявата!",e)})};var C=$("#panel"),v=$(".show-publish");g.toggleCode=function(){C.toggleClass("viewCode"),v.toggleClass("md-accent").toggleClass("md-primary")}}angular.module("app").controller("AdminController",AdminController);